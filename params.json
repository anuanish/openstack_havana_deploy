{"name":"Openstack havana deploy","tagline":"Deployment Tool for OpenStack Havana Release with Ubuntu Cloud Archive","body":"OpenStack Havana Installation Script\r\n====\r\n\r\nOpenStack Havana Installation Bash Script for Ubuntu Server 12.04 LTS.\r\n\r\nAuthor\r\n----\r\n\r\nTomokazu Hirai @jedipunkz\r\n\r\nTwitter : <https://twitter.com/jedipunkz>\r\nBlog    : <http://jedipunkz.github.io>\r\n\r\nNotice\r\n----\r\n\r\nThis script was tested ..\r\n\r\n* all in one node with neutron (vlan mode)\r\n* separated nodes (controller node, network node, compute x n) with neutron (vlan mode)\r\n\r\nin these cases, it is not already done.\r\n\r\n* all in one node with nova-network\r\n* separated nodes (controller node, compute x n) with nova-network\r\n\r\nMotivation\r\n----\r\n\r\ndevstack is very usefull for me. I am using devstack for understanding\r\nopenstack, especially Neutron ! ;) but when I reboot devstack node, all of\r\nopenstack compornents was not booted. That is not good for me. and I wanted to\r\nuse Ubuntu Cloud Archive packages.\r\n\r\nRequire Environment\r\n----\r\n\r\n#### Cinder Device\r\n\r\nIf you want use REAL disk device for cinder such as /dev/sdb, please input disk\r\ndevice name to $CINDER_VOLUME in setup.conf. If you do not have any additional\r\ndisk for cinder, you can use loopback device. So please input loopback device\r\nname such as /dev/loop3.\r\n\r\n#### In All in ne node mode\r\n\r\nYou need 2 NICs (management network, public network). You can run this script\r\nvia management network NIC. VM can access to the internet via public network\r\nNIC (default : eth0, You can change device on setup.conf).\r\n\r\n#### In separated nodes mode\r\n\r\nYou need 3 NICs for ..\r\n\r\n* management network\r\n* public network / API network (default: eth0)\r\n* data network (default: eth1)\r\n\r\nfor more details, please see this doc. \r\n\r\n<http://docs.openstack.org/trunk/openstack-network/admin/content/app_demo_single_router.html>\r\n\r\nNeutron was designed on 4 networks (public, data, managememt, api) so You can\r\n3 NICs on separated nodes mode. API network and Public network can share same\r\nnetwork segment or you can separate these networks. This README's\r\nconfiguration of the premise is sharing a segment with API and Public network\r\n(default NIC : eth0).\r\n\r\nHow to use on All in One Node with neutron\r\n----\r\n\r\n#### Architecture\r\n\r\n    +------------------- Public/API Network\r\n    |\r\n    +------------+\r\n    |vm|vm|...   |\r\n    +------------+\r\n    | all in one |\r\n    +------------+\r\n    |     |      \r\n    +-----)------------- Management/API Network\r\n          |             \r\n          +------------- Data Network\r\n\r\n* all of compornetns are on same node.\r\n\r\n#### Setup network interfaces\r\n\r\nPlease setup network interfaces just like this.\r\n\r\n    % sudo ${EDITOR} /etc/network/interfaces\r\n    auto lo\r\n    iface lo inet loopback\r\n    \r\n    # this NIC will be used for VM traffic to the internet\r\n    auto eth0\r\n    iface eth0 inet static\r\n        up ifconfig $IFACE 0.0.0.0 up\r\n        up ip link set $IFACE promisc on\r\n        down ip link set $IFACE promisc off\r\n        down ifconfig $IFACE down\r\n        address 10.200.9.10\r\n        netmask 255.255.255.0\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n        dns-search example.com\r\n\r\n    auto eth1\r\n    iface eth1 inet static\r\n        address 172.16.0.10\r\n        netmask 255.255.255.0\r\n\r\n    # this NIC must be on management network\r\n    auto eth2\r\n    iface eth2 inet static\r\n        address 10.200.10.10\r\n        netmask 255.255.255.0\r\n        gateway 10.200.10.1\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n\r\nlogin and use this script via eth1 on management network. eth0 will be lost\r\nconnectivity when you run this script. and make sure hostname resolv at\r\n/etc/hosts. in this sample, your host need resolv self fqdn in 10.200.10.10\r\n\r\n#### Get this script\r\n\r\ngit clone this script from github.\r\n\r\n    % git clone git://github.com/jedipunkz/openstack_havana_deploy.git\r\n    % cd openstack_havana_deploy\r\n    % cp setup.conf.samples/setup.conf.allinone.neutron setup.conf\r\n    \r\n#### Edit parameters on setup.conf\r\n\r\nThere are many paramaters on setup.conf, but in 'allinone' mode, parameters\r\nwhich you need to edit is such things.\r\n\r\n    HOST_IP='10.200.10.10'\r\n    HOST_PUB_IP='10.200.9.10'\r\n    PUBLICNETWORK_NIC_NETWORK_NODE='eth0'\r\n    NETWORK_COMPONENT='neutron'\r\n\r\nIf you want to change other parameters such as DB password, admin password,\r\nplease change these.\r\n\r\n#### Run script\r\n\r\nRun this script, all of conpornents will be built.\r\n\r\n    % sudo ./setup.sh allinone\r\n    % sudo ./setup.sh create_network\r\n\r\nThat's all and You've done. :D Now you can access to Horizon\r\n(http://${HOST_IP}/horizon/) with user 'demo', password 'demo'.\r\n\r\nHow to use on separated nodes mode with quatum\r\n----\r\n\r\n#### Architecture\r\n\r\n    +-------------+-------------+------------------------------ Public/API Network\r\n    |             |             |             \r\n    +-----------+ +-----------+ +-----------+ +-----------+ +-----------+\r\n    |           | |           | |           | |vm|vm|..   | |vm|vm|..   |\r\n    | controller| |  network  | |  network  | +-----------+ +-----------+\r\n    |           | |           | | additional| |  compute  | |  compute  |\r\n    |           | |           | |           | |           | | additional|\r\n    +-----------+ +-----------+ +-----------+ +-----------+ +-----------+\r\n    |             |     |       |     |       |     |       |\r\n    +-------------+-----)-------+-----)-------+-----)-------)-- Management/API Network\r\n                        |             |             |       |\r\n                        +-------------+-------------+---------- Data Network\r\n\r\n* minimum architecture : 3 nodes (controller node x 1, network node x 1, compute node x1)\r\n* You can add some network nodes and compute nodes.\r\n* additional network node(s) make you be able to have duplication of each agent\r\n* additional compute node(s) make you be able to have more VMs.\r\n\r\n#### Get this script\r\n\r\ngit clone this script from github on controller node.\r\n\r\n    controller% git clone git://github.com/jedipunkz/openstack_havana_deploy.git\r\n    controller% cd openstack_havana_deploy\r\n    controller% cp setup.conf.samples/setup.conf.separated.neutron setup.conf\r\n    \r\n#### Edit parameters on setup.conf\r\n\r\nThere are many paramaters on setup.conf, but in 'allinone' mode, parameters\r\nwhich you need to edit is such things.\r\n\r\n    CONTROLLER_NODE_IP='10.200.10.10'\r\n    CONTROLLER_NODE_PUB_IP='10.200.9.10'\r\n    NETWORK_NODE_IP='10.200.10.11'\r\n    COMPUTE_NODE_IP='10.200.10.12'\r\n    DATANETWORK_NIC_NETWORK_NODE='eth1'\r\n    DATANETWORK_NIC_COMPUTE_NODE='eth0'\r\n    PUBLICNETWORK_NIC_NETWORK_NODE='eth0'\r\n    NETWORK_COMPONENT='neutron'\r\n    \r\nIf you want to change other parameters such as DB password, admin password,\r\nplease change these.\r\n\r\n#### copy to other nodes\r\n\r\ncopy directory to network node and compute node.\r\n\r\n    controller% scp -r openstack_havana_deploy <network_node_ip>:~/\r\n    controller% scp -r openstack_havana_deploy <compute_node_ip>:~/\r\n\r\n#### Controller Node's network interfaces\r\n\r\nSet up NICs for controller node.\r\n\r\n    controller% sudo ${EDITOR} /etc/network/interfaces\r\n    # The loopback network interface\r\n    auto lo\r\n    iface lo inet loopback\r\n    \r\n    # for API network\r\n    auto eth0\r\n    iface eth0 inet static\r\n        address 10.200.9.10\r\n        netmask 255.255.255.0\r\n        gateway 10.200.9.1\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n        dns-search example.com\r\n\r\n    # for management network\r\n    auto eth1\r\n    iface eth1 inet static\r\n        address 10.200.10.10\r\n        netmask 255.255.255.0\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n        dns-search example.com\r\n\r\nand login to controller node via eth0 (public network) for executing this script.\r\nOther NIC will lost connectivity. and make sure hostname resolv at\r\n/etc/hosts. in this sample, your host need resolv self fqdn in 10.200.9.10\r\n\r\n#### Network Node's network interfaces\r\n\r\nSet up NICs for network node.\r\n\r\n    network% sudo ${EDITOR} /etc/network/interfaces\r\n    # The loopback network interface\r\n    auto lo\r\n    iface lo inet loopback\r\n    \r\n    # for API network\r\n    auto eth0\r\n    iface eth0 inet static\r\n        up ifconfig $IFACE 0.0.0.0 up\r\n        up ip link set $IFACE promisc on\r\n        down ip link set $IFACE promisc off\r\n        down ifconfig $IFACE down\r\n        address 10.200.9.11\r\n        netmask 255.255.255.0\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n        dns-search example.com\r\n\r\n    # for VM traffic to the internet\r\n    auto eth1\r\n    iface eth1 inet static\r\n        address 172.16.1.11\r\n        netmask 255.255.255.0\r\n\r\n    # for management network\r\n    auto eth2\r\n    iface eth2 inet static\r\n        address 10.200.10.11\r\n        netmask 255.255.255.0\r\n        gateway 10.200.10.1\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n        dns-search example.com\r\n\r\nand login to network node via eth2 (management network) for executing this\r\nscript. Other NIC will lost connectivity.\r\n\r\n#### Compute Node's network interfaces\r\n\r\nSet up NICs for network node.\r\n\r\n    compute% sudo ${EDITOR} /etc/network/interfaces\r\n    # The loopback network interface\r\n    auto lo\r\n    iface lo inet loopback\r\n    \r\n    # for VM traffic to the internet\r\n    auto eth0\r\n    iface eth0 inet static\r\n        address 172.16.1.12\r\n        netmask 255.255.255.0\r\n\r\n    # for management network\r\n    auto eth1\r\n    iface eth1 inet static\r\n        address 10.200.10.12\r\n        netmask 255.255.255.0\r\n        gateway 10.200.10.1\r\n        dns-nameservers 8.8.8.8 8.8.4.4\r\n        dns-search example.com\r\n\r\nand login to compute node via eth2 (mangement network) for executing this\r\nscript. Other NIC will lost connectivity.\r\n\r\n#### Run script\r\n\r\nRun this script, all of conpornents will be built.\r\n\r\n    controller% sudo ./setup.sh controller\r\n    network   % sudo ./setup.sh network\r\n    compute   % sudo ./setup.sh comupte\r\n    controller% sudo ./setup.sh create_network # <- creating virtual network\r\n\r\nThat's all and You've done. :D Now you can access to Horizon\r\n(http://${CONTROLLER_NODE_PUB_IP}/horizon/) with user 'demo', password 'demo'.\r\n\r\n#### Additional Compute Node\r\n\r\nIf you want to have additional compute node(s), please setup network\r\ninterfaces as noted before for compute node and execute these commands.\r\n\r\nEdit setup.conf (COPUTE_NODE_IP parameter) and execute setup.sh.\r\n\r\n    compute    % scp -r ~/openstack_havana_deploy <add_compute_node>:~/\r\n    add_compute% cd openstack_havana_deploy\r\n    add_compute% ${EDITOR} setup.conf\r\n    COMPUTE_NODE_IP='<your additional compute node's ip>'\r\n    add_compute% sudo ./setup.sh compute\r\n    add_compute% sudo nova-manage service list # check nodes list\r\n\r\n#### Additional Network Node\r\n\r\nIf you want to have additional network node(s), please setup network\r\ninterfaces as noted before for network node and execute these commands.\r\n\r\nEdit setup.conf (NETWORK_NODE_IP parameter) and execute setup.sh.\r\n\r\n    network    % scp -r ~/openstack_havana_deploy <add_network_node>:~/\r\n    add_network% cd openstack_havana_deploy\r\n    add_network% ${EDITOR} setup.conf\r\n    NETWORK_NODE_IP='<your additional network node's ip>'\r\n    add_network% sudo ./setup.sh network\r\n    add_network% source ~/openstackrc\r\n    add_network% neutron agent-list # check agent list\r\n    \r\n\r\nParameters\r\n----\r\n\r\nThese are Meaning of parameters.\r\n\r\n* host_ip : ip addr on management network with 'allinone' node\r\n* host_pub_ip : ip addr on public network with 'allinone' node\r\n* public_nic : nic name on public network with 'allinone' node\r\n* controller_node_ip : ip addr on management network with controller node\r\n* controller_node_pub_ip : ip addr on public network with controller node\r\n* network_node_ip : ip addr on management network with network node\r\n* compute_node_ip : ip addr on management network with compute node\r\n* data_nic_controller : nic name on data network with controller node\r\n* data_nic_compute : nic name on data network with compute nod\r\n* public_nic : nic name on public network on network node\r\n* cinder_volume : disk device name for cinder volume\r\n* mysql_pass : root password of mysql\r\n* db_keystone_user : mysql user for keystone\r\n* db_keystone_pass : mysql password for keystone\r\n* db_glance_user : mysql user for glance\r\n* db_glancepass : mysql password for glance\r\n* db_neutron_user : mysql user for neutron\r\n* db_neutron_pass : mysql password for neutron\r\n* db_nova_user : mysql user for nova\r\n* db_nova_pass : mysql password for nova\r\n* db_cinder_user : mysql user for cinder\r\n* db_cinder_pass : mysql password for cinder\r\n* admin_password : keystone password for admin user\r\n* service_password : keystone password for service user\r\n* os_tenant_name : os tenant name\r\n* os_username : os username\r\n* os_password : os password\r\n* demo_user : first user for demo\r\n* demo_password : first user's password for demo\r\n* int_net_gateway : gateway address of internal network\r\n* int_net_range : range of external network\r\n* ext_net_gateway : gateway address of external network\r\n* ext_net_start : starging address of external network\r\n* ext_net_end : ending address of external network\r\n* ext_net_range : range of external network\r\n* os_image_url : url for downloading os image file\r\n* os_image_name : name of os image name for glance service\r\n\r\nLicensing\r\n----\r\n\r\nThis Script  is licensed under a Creative Commons Attribution 3.0 Unported License.\r\n\r\nTo view a copy of this license, visit\r\n[ http://creativecommons.org/licenses/by/3.0/deed.en_US ].\r\n\r\nKnown Issue\r\n----\r\n\r\n* can not create heat stack\r\n* can not access vm via neutron gre tunnel (see bug https://bugs.launchpad.net/neutron/+bug/1238445)\r\n* not implemented ceilometer\r\n\r\nVersion and Change log\r\n----\r\n\r\n* version 0.1 : 25th Oct 2013 : first version of release. tested for neutron mode only.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}